package eu.assuremoss.utils;

import eu.assuremoss.framework.model.VulnerabilityEntry;
import org.junit.Assert;
import org.junit.jupiter.api.Test;

import java.nio.file.Paths;

public class VulnerabilityEntryComparatorTest {
    @Test
    public void compareSameEntries() {
        VulnerabilityEntry same_1 = new VulnerabilityEntry();
        same_1.setType("EI_EXPOSE_REP2");
        same_1.setVulnType("FB_EiER");
        same_1.setDescription("example.ArrayDemo.withPermissionsToGive(String[]) may expose internal representation by storing an externally mutable object into ArrayDemo.permissionsToGive");
        same_1.setPath(String.valueOf(Paths.get("test-project", "src", "main", "java", "example", "ArrayDemo.java")));
        same_1.setVariable(null);
        same_1.setStartLine(24);
        same_1.setEndLine(24);

        VulnerabilityEntry same_2 = new VulnerabilityEntry();
        same_2.setType("EI_EXPOSE_REP2");
        same_2.setVulnType("FB_EiER");
        same_2.setDescription("example.ArrayDemo.withPermissionsToGive(String[]) may expose internal representation by storing an externally mutable object into ArrayDemo.permissionsToGive");
        same_2.setPath(String.valueOf(Paths.get("test-project", "src", "main", "java", "example", "ArrayDemo.java")));
        same_2.setVariable(null);
        same_2.setStartLine(24);
        same_2.setEndLine(23);

        Assert.assertTrue(same_1.equals(same_2));

    }

    @Test
    public void compareDifferentEntries() {}
}
